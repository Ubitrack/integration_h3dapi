<?xml version="1.0" encoding="utf-8"?>
<X3D profile='H3DAPI' version='1.4'>
  <head>
    <meta name='title' content='ubitrack_test.x3d'/>
    <meta name='description' content='test scene for ubitrack.'/>
    <meta name='author' content='Magic  Vision Lab'/>
  </head>
  <ImportLibrary library="h3dubitrack_vc10.dll" />
  <Scene>
  
	<UbitrackInstance url="ubitrack_test_win_vuzix_stereo.dfg" autoStart="true" 
					  componentDir="H:\\Libraries\\UbiTrack-build\\bin\\ubitrack"
					  log4cppConfig="H:/H3D/bin32/log4cpp.conf">
	  <PoseReceiver pattern="ImageReady" mode="PUSH" DEF="SYNC" isSyncSource="true"/>
	  <ImageReceiver pattern="CameraImageLeft" mode="PULL" DEF="CAM_IMG_LEFT">
		  <UTImageTexture DEF="TEXTURE0" />
	  </ImageReceiver>
	  <ImageReceiver pattern="CameraImageRight" mode="PULL" DEF="CAM_IMG_RIGHT">
		  <UTImageTexture DEF="TEXTURE1" />
	  </ImageReceiver>
	  <PoseReceiver pattern="TrackerPose" mode="PULL" DEF="OBJ_POSE"/>
	</UbitrackInstance>

	<!--
	<UTCameraViewpoint DEF="VP" fieldOfView="0.32463124087094525">
	  <PoseReceiver USE="OBJ_POSE" containerField="tracker" />
	</UTCameraViewpoint>
	-->
	<PythonScript url="viewpoint_setup.py" DEF="PS" />
	
	<UTCameraViewpoint DEF="VP" fieldOfView="0.32463124087094525">
	  <PoseReceiver USE="OBJ_POSE" containerField="tracker" />
	</UTCameraViewpoint>

	<ROUTE fromNode="PS" fromField="cameraIntrinsics" toNode="VP" toField="cameraIntrinsics" />
	<ROUTE fromNode="PS" fromField="cameraResolution" toNode="VP" toField="cameraResolution" />
	<ROUTE fromNode="PS" fromField="eyeTransform" toNode="VP" toField="eyeTransform" />

	<UTImageBackground>
	  <UTImageTexture USE="TEXTURE0" />
	  <UTImageTexture USE="TEXTURE1" />
	</UTImageBackground>

    <Transform DEF="TRANSFORM_SHAPE">
    <Shape>
      <Appearance>
	      <Material diffuseColor="1 0 0" />
      </Appearance>      
      <Box size='0.02 0.01 0.05' solid='true' />
    </Shape>
    </Transform>


  </Scene>
</X3D>
